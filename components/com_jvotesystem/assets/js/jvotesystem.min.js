/**
 * @package Component jVoteSystem for Joomla! 1.5-2.5
 * @projectsite www.joomess.de/projects/jvotesystem
 * @authors Johannes Meßmer, Andreas Fischer
 * @copyright (C) 2010 - 2012 Johannes Meßmer
 * @license GNU/GPLv3 http://www.gnu.org/licenses/gpl-3.0.html
 **/
function jVS_constructor(){var me={},reqcount=0,$=jVSQuery,ajaxerror='<div style="font-size:15px;font-weight:bold;color:#f00;text-align:center;line-height:30px;padding: 0 20px;border:4px solid #f00;background:#000;">jVoteSystem Debug: AJAX failed!<br/>Deleting remaining requests!</div>',toomany='<div style="font-size:15px;font-weight:bold;color:#f00;text-align:center;line-height:30px;padding: 0 20px;border:4px solid #f00;background:#000;">jVoteSystem Debug: Too many requests!<br/>Deleting remaining requests!</div>',ajaxqueue=[];me.jLang;me.ajax=function(a){if(a==undefined){ajaxqueue=[];return}if(ajaxqueue.length>10){me.ajax();me.error(toomany);return}var b=a.complete;a.complete=function(a,c){ajaxqueue.shift();if(b)b(a,c);if(ajaxqueue.length>0)$.ajax(ajaxqueue[0])};ajaxqueue.push(a);if(ajaxqueue.length===1)$.ajax(a)};me.req=function(a,b){me.load(a.box);me.getlang();var c={option:"com_jvotesystem",view:"ajaxjson",paramView:$("[data-box="+a.box+"]").data("view"),only_page:1};$.extend(c,a);me.ajax({url:jvs_live_url+"index.php?"+jvs_token+"=1",cache:false,type:"POST",data:c,dataType:"json",complete:function(){me.done(a.box)},success:function(a){b(a)},error:function(){}})};me.convertToHex=function(a){if(a=="transparent"||a=="rgba(0, 0, 0, 0)")return"transparent";if(a.substr(0,1)=="#")return a;a=a.match(/^rgb\((\d+),\s*(\d+),\s*(\d+)\)$/);return"#"+("0"+parseInt(a[1],10).toString(16)).slice(-2)+("0"+parseInt(a[2],10).toString(16)).slice(-2)+("0"+parseInt(a[3],10).toString(16)).slice(-2)};me.trigger=function(a,b){try{var c=Array.prototype.slice.call(arguments).splice(2);var d=window["jVS"][me.gettemplate(a)];var e=b.split(".");var f=e.pop();for(var g=0;g<e.length;g++){d=d[e[g]]}if($.isFunction(d[f])){return d[f].apply(this,c)}}catch(h){return false}return false};me.getlang=function(a,b){if(me.jLang==undefined){me.ajax({url:jvs_live_url+"index.php?"+jvs_token+"=1",cache:true,async:false,type:"POST",dataType:"json",data:{option:"com_jvotesystem",view:"ajaxjson",task:"getlang",only_page:1},success:function(c){me.jLang=c;if($.isFunction(b))b(a)}})}else{if($.isFunction(b))b(a)}};me.translateStr=function(a){me.getlang();$.each(me.jLang,function(b,c){if(b.toLowerCase()==a.toLowerCase()){a=c;return false}});return a};me.zebraDialogBox;me.info=function(a){me.getlang();if(a.buttons)for(i=0;i<a.buttons.length;i++)a.buttons[i]=me.translateStr(a.buttons[i]);me.zebraDialogBox=new $.Zebra_Dialog(a.message,{type:a.type,title:a.title,overlay_opacity:.1,buttons:a.buttons,onClose:a.callback,position:a.position,auto_close:a.autoclose,modal:a.modal,width:a.width});return me.zebraDialogBox};me.notify=function(a){var b=$("div.ZebraDialog:not(:has(div.jvotesystem))").last();var c=parseInt($(b).css("top"))+$(b).height()||0;me.info({type:"confirmation",title:false,message:a,buttons:false,position:["right - 20","top + "+(20+c)],autoclose:2e3,modal:false})};me.error=function(a){me.info({type:a?"error":false,title:false,message:a||ajaxerror,button:["OK"]})};me.load=function(a){$("[data-box="+a+"]").spin()};me.done=function(a){$("[data-box="+a+"]").spin(false)};me.lock=function(a){};me.unlock=function(a){};me.getboxobj=function(a){};me.gettemplate=function(a){var b=$(a).closest("div.jvotesystem");if(b.length!==1){console.log("me.gettemplate: number of elements: "+b.length);return"default"}return b.attr("class").replace(/^.*jvs-(\w+)/g,"$1")};me.round=function(a,b){if(isNaN(a))return 0;var c=Math.round(a*Math.pow(10,b))/Math.pow(10,b);return c};me.jsbarchart=function(a,b,c,d,e){me.getlang();$("div[data-box="+c+"] .newanswerbox, div[data-box="+c+"] .makenew").hide();$("div[data-box="+c+"] .barchart").addClass("active").removeClass("inactive");var f=$('<div class="jsbarchart"></div>').appendTo($("div[data-box="+c+"] .pagebox").html(""));var g=0,h=0,i=true;for(var j=0,k=a.length;j<k;j++){g+=a[j];if(a[j]>h)h=a[j]}var l=["#3366cc","#dc3912","#ff9900","#109618","#990099","#0099c6","#dd4477","#66aa00","#b82e2e","#316395","#994499","#22aa99","#aaaa11","#6633cc","#e67300","#8b0707"];var m=0;var n=$("div[data-box="+c+"]").data("lastviewpage");var o=e;if(n)o=e*n;for(var j=0,k=a.length;j<k;j++){if(l[m]==undefined)m=0;var p=$('<div class="barbox" style="display:'+(j>o-1?"none":"block")+'"></div>');$("<p><span>"+b[j]+" </span><span>("+"0%)</span></p>").appendTo(p);var q=$("<div>").html('<a style="background-color:'+(l[m]||"#000")+';"></a>').appendTo(p);if(isNaN(a[j]/h)===false&&a[j]>0){q.delay(500).animate({width:a[j]/h*100+"%"},{easing:"linear",duration:"slow",step:function(a,b){$(b.elem).prev().children("span:last").html("("+me.round(a/g*h,0)+"%)")}})}$(p).appendTo(f);m++}f.after(d);f.next().find("a.scaling").click(function(){var b=f.find("div > div");for(var c=0,d=a.length;c<d;c++){if($(b[c]).width()===0)continue;if(i==false){$(b[c]).animate({width:a[c]/h*100+"%"},"slow")}else if(i==true){$(b[c]).animate({width:a[c]/g*100+"%"},"slow")}}i==false?$(this).html("Relatif"):$(this).html("Absolu");i==false?i=true:i=false});if(a.length>e-1){f.next().on("click","a.showall",function(){$("div.barbox:not(:visible):lt("+e+")",f).slideDown("slow");if($("div.barbox:not(:visible)",f).length===0)$(this).attr("class","hideall").text(me.jLang.hideall)}).on("click","a.hideall",function(){$("div.barbox:gt("+(e-1)+")",f).slideUp("slow");$(this).attr("class","showall").text($(d).find("a.showall").dp("short")?me.jLang.load_next_short:me.jLang.load_next.replace("%STEPS%",e))})}};me.googleapiloaded=false;me.googleapiloading=false;me.jspiechart=function(a,b,c){$("div[data-box="+c+"] div.newanswerbox, div[data-box="+c+"] .makenew").hide();$("div[data-box="+c+"] .piechart").addClass("active").removeClass("inactive");var d=$('<div class="jspiechart" id="jvs_piechart_'+c+'"></div>').appendTo($("div[data-box="+c+"] .pagebox").html(""));d.bind("googleLoaded",function(){var e=new google.visualization.DataTable;e.addColumn("string","Answer");e.addColumn("number","Votes");for(var f=0,g=a.length;f<g;f++){e.addRow([b[f],a[f]])}var h=d.width();var i=h*(400/725);var j=false;var k={width:"100%",height:i,chartArea:{width:"95%",height:"80%"},backgroundColor:me.convertToHex(d.css("backgroundColor")),legend:{textStyle:{color:me.convertToHex(d.closest(".jvotesystem").css("color"))}}};var l=function(){j=false;var a=new google.visualization.PieChart($("#jvs_piechart_"+c)[0]);google.visualization.events.addListener(a,"ready",function(){j=true});a.draw(e,k)};var m;$(window).resize(function(){if(!j)return;window.clearTimeout(m);$("#jvs_piechart_"+c).html("");m=window.setTimeout(function(){l()},200)});l();$(this).unbind("googleLoaded")});if(!me.googleapiloaded&&!me.googleapiloading){me.googleapiloading=true;var e=document.createElement("script");e.src="http://www.google.com/jsapi?callback=jVS.googleLoadCallback";e.type="text/javascript";document.getElementsByTagName("head")[0].appendChild(e)}if(me.googleapiloaded&&!me.googleapiloading)d.trigger("googleLoaded")};me.googleLoadCallback=function(){me.googleapiloading=false;me.googleapiloaded=true;google.load("visualization","1",{packages:["corechart"],callback:function(){$(".jvotesystem .jspiechart").trigger("googleLoaded")}})};me.loadcharts=function(a){var b=$(a).dp("box");if($(a).hasClass("chart"))var c=$(a).hasClass("piechart")?"pie":"bar";else{var d=$("div[data-box="+b+"]");var c=d.dp("chart");if(!c)c="bar";a=d.find(".chart."+c+"chart");d.find(".chart").fadeIn("slow")}if(!$(a).hasClass("active")){me.req({task:"loadCharts",box:b,mode:c,template:me.gettemplate($("[data-box="+b+"]"))},function(b){if(b.erfolg){if(b.allowed){if(a!=undefined){$(a).siblings().addClass("inactive").removeClass("active");$(a).removeClass("inactive").addClass("active")}if(b.mode=="pie")me.jspiechart(b.values,b.answers,b.box);else if(b.mode=="bar")me.jsbarchart(b.values,b.answers,b.box,b.code,b.count)}else{me.error("InfoLeave");me.leavecharts(a)}}else{me.error(b.error)}})}else{me.error("Info");me.leavecharts(a)}};me.leavecharts=function(a){var b=$(a);var c=b.dp("box");var d=b.closest("div.jvotesystem");if(!me.trigger(a,"leavecharts",b,c,d)){if(b!=undefined&&b.data!=undefined){b.addClass("inactive").removeClass("active")}$("div[data-box="+c+"] div.newanswerbox, div[data-box="+c+"] .makenew").fadeIn("slow");me.go(d,d.data("lastviewpage"),0)}};me.vote=function(a){me.trigger(a,"beforeVoting");var b=$(a).closest("div.answer");var c=b.dp("box");var d=b.dp("a");var e=me.gettemplate(b);var f=b.find(".votecount");var g=b.find("p.votecounttext");var h=b.closest("div.jvotesystem").find("span.count");if(h.intg()<=0)return false;f.incr();h.decr();me.req({task:"vote",box:c,answer:d,template:e},function(b){me.voted(b,a)})};me.voted=function(a,b){var c=$(b).closest("div.answer");var d=c.dp("box");var e=c.dp("a");var f=me.gettemplate(c);var g=c.find("span.votecount");var h=c.find("p.votecounttext");var i=c.closest("div.jvotesystem").find("span.count");var j=c.find("a.vote");if(a.error&&a.captcha==0){me.info({type:"error",title:"get.title",message:a.error,button:["OK","Cancel"],callback:function(){me.showcaptcha({task:"vote",box:d,answer:e,exec:function(a){me.voted(a,b)}})}})}else if(a.captcha==0){me.showcaptcha({task:"vote",box:d,answer:e,exec:function(a){me.voted(a,b)}});g.decr();i.incr()}else if(a.erfolg==1){if(a.disableanswer){me.notify(a.voteLimitMax);$(j).attr({"data-disabled":1});j.addClass("novote");j.removeClass("vote")}if(a.thankyou_title){me.info({type:"information",title:a.thankyou_title,message:a.thankyou_message,button:["OK"]});j.addClass("novote");j.removeClass("vote")}if(a.make_userlist&&me.gettemplate(b)!=="module"&&c.find("div.count a.userlist").length===0){$('<a class="icon userlist"></a>').hide().prependTo(c.find("div.count")).fadeIn("slow")}if(a.userVotes>0){c.find(".ownvotes").html(a.userVotes);if(a.show_votereset){c.find(".vote-down:hidden").fadeIn()}}if(a.totalVotes===1){h.html(me.jLang.votessingular)}else{h.html(me.jLang.votesplural)}if(a.goto_chart){me.loadcharts(b)}if(a.goto_box){me.go(c,a.page)}if(g.length!==0&&a.totalVotes&&g.intg()<a.totalVotes){g.html(a.totalVotes)}if(a.leftVotes===0){c.closest("div.jvotesystem").find("a.vote").attr("class","novote");c.closest("div.jvotesystem").find(".votebutton").hide()}if(a.leftVotes&&i.intg()>a.leftVotes)i.html(a.leftVotes)}else{me.error(a.error);g.decr();i.incr();if(a.leftVotes===0)me.go(c);if(g.length!==0&&a.totalVotes)g.html(a.totalVotes)}};me.votebutton=function(a){me.getlang();var b=$(a).closest("div.jvotesystem");var c=b.find("div.pagebox");var d=$('<div class="votebutton"><div>'+me.jLang.vote+"</div></div>").click(function(){me.vote(b.find("input:checked"))});d.insertAfter(c).slideDown("slow")};me.resetvotes=function(a){var b=$(a).closest("div.answer");var c=b.dp("box");var d=b.dp("a");var e=b.find("span.votecount");var f=b.closest("div.jvotesystem").find("span.count");var g=$(a).find(".ownvotes").intg();var h=parseInt($(a).dp("steps"));if(!h)h=g;var i=b.find("a.votingbutton");g=g-h;if(g<0)return;var j=e.intg()-h;e.html(j);var k=f.intg();if(f.length==0)k=0;f.html(k+h);if(g==0)$(a).fadeOut();$(a).find(".ownvotes").html(g);me.req({task:"resetvotes",box:c,answer:d,reset:h},function(a){if(a.erfolg===1){i.removeClass("novote");i.addClass("vote");if(j==0)b.find(".icon.userlist").fadeOut("slow",function(){$(this).remove()});if(k==0)me.go(b,b.dp("lastviewpage"))}else{me.error(a.error)}})};me.go=function(a,b,c){var d=a.closest("div.jvotesystem");if(me.lock(d))return;var e=a.dp("box");b=a.data("p")||b;var f=d.find("div.pagebox");var g=f.find("div[data-p]").last();var h=me.gettemplate(d);c=c!=undefined?c:g.data("p")||d.data("lastviewpage");if(!me.trigger(a,"go",d,e,b,f,g,h,c)){me.req({task:"answers",box:e,page:b,currentPage:c,template:h},function(a){me.unlock(d);if(a.erfolg===1){d.attr("data-lastviewpage",g.data("p"));if(a.page===a.currentPage||f.find("div.jsbarchart,div.jspiechart").length>0||f.children().length>1){var b=f.children();var c=f.prepend(a.code).find("div[data-p]");var h=function(){f.height("auto")};f.animate({height:c.height()},"slow",function(){h()});b.remove();c.hide().css({position:"relative"}).fadeIn("slow")}else{var b=g;f.css("overflow","hidden");f.prepend(a.code);var c=b.prev();var i=b.width();var j=c.height();var k=a.currentPage>a.page?-1:1;c.css("left",i*k);f.animate({height:j},800);b.animate({height:j,left:-i*k},800);c.animate({left:0},810,function(){b.remove();c.css({position:"relative",height:"auto"});f.height("auto");f.css("overflow","visible")});if(f.offset().top<$(window).scrollTop())me.scrollto(f)}if(a.banner_code!=undefined)me.loadBannerScript(e,a.banner_code)}else{me.error(a.error)}})}};me.addanswer=function(a){me.getlang();if(!me.trigger(a,"addanswer",a)){var b=$(a).closest("div.jvotesystem");var c=b.find(".newanswerbox textarea").val();if(c===b.find(".newanswerbox textarea").data("start")||me.removebb(c)===""){me.error(me.jLang.noemptyordefault);return}fixboxobj=$("div.jvotesystem[data-box="+b.dp("box")+"]").first();me.lock(fixboxobj);me.req({task:"addAnswer",box:b.dp("box"),answer:c},function(a){me.answeradded(a,fixboxobj)})}};me.removebb=function(a){var b=a.split("");var c=false;var d="";for(var e=0;e<b.length;e++){if(b[e]==="[")c=true;else if(b[e]==="]")c=false;else if(c===false)d+=b[e]}return d.replace(/^\s+|\s+$/g,"")};me.answeradded=function(a,b){if(a.error&&a.captcha==0){me.info({type:"error",title:"get.title",message:a.error,button:["OK","Cancel"],callback:function(){me.showcaptcha({task:"addAnswer",box:a.box,answer:a.text,exec:function(a){me.answeradded(a,b)}})}})}else if(a.captcha==0){me.showcaptcha({task:"addAnswer",box:a.box,answer:a.text,exec:function(a){me.answeradded(a,b)}})}else if(a.erfolg==1){me.trigger(b,"answerAdded");me.unlock(b);me.go(b,a.page);b.find("span.count").html(a.leftVotes);$("[data-box="+a.box+"] .newanswerbox input[name=reset]").trigger("click");me.notify(a.success)}else{me.unlock(b);me.error(a.error)}};me.showcaptcha=function(a){me.getlang();code=me.jLang.captchaLoading;me.info({type:false,title:me.jLang.captchaEnterCode,message:'<div id="captchahere">'+code+"</div>",buttons:["OK","Cancel"],width:"339",callback:function(b){me.enteredCaptcha(b,a)}});showRecaptcha("captchahere","red",function(){$("#recaptcha_response_field").keypress(function(b){if(b.which==13){me.enteredCaptcha(1,a);me.zebraDialogBox.close()}})})};me.enteredCaptcha=function(a,b){if(a!==1)return;var c=$("#recaptcha_response_field").val()||0;var d=$("#recaptcha_challenge_field").val();var e=b.exec;delete b.exec;$.extend(b,{captcha:c,recaptcha_challenge_field:d});me.req(b,function(a){e(a)})};me.removeanswer=function(a){me.getlang();var b=$(a).closest("div.answer").css("background-color","#FFE4E1");var c=b.closest("div.jvotesystem");var d=c.find("span.count");me.info({type:"question",title:me.jLang.titleQuestion,message:me.jLang.qremoveanswer,buttons:["Yes","No"],callback:function(a){if(a===1){me.req({task:"removeAnswer",box:b.dp("box"),answer:b.dp("a")},function(a){if(a.erfolg==1){me.notify(a.success);d.html(a.leftVotes);if(a.leftVotes>0)c.find("a.novote:not([data-disabled])").addClass("class","vote").removeClass("class","novote");if(c.find("div[data-a]").length>1){b.animate({height:0},"slow",function(){b.nextAll().find("div.rank").decr();b.remove();c.data("answerremoved","true")})}else me.go(c.find("div[data-p]"))}else{me.error(a.error);b.css("background-color","transparent")}})}else{b.css("background-color","transparent")}}})};me.changeanswerstate=function(a){var b=$(a).closest("div.answer");me.req({task:"changePublishStateAnswer",box:b.dp("box"),answer:b.dp("a")},function(a){if(a.erfolg){me.notify(a.success);b.find("a.state:first").toggleClass("published unpublished")}else{me.error(a.error)}})};me.reportanswer=function(a){me.getlang();var b=$(a).closest("div.answer");me.info({type:"question",title:me.jLang.titleQuestion,message:me.jLang.qreportanswer+"<br /> "+me.jLang.reportAddMessage+'<textarea id="jVS-report-message" cols=30 rows=2></textarea>',buttons:["Send","Cancel"],callback:function(c){if(c===1){me.req({task:"reportAnswer",box:b.dp("box"),answer:b.dp("a"),reportMessage:$("#jVS-report-message").val()},function(b){if(b.erfolg){me.notify(b.success);$(a).remove()}else{me.error(b.error)}})}}})};me.loaduserlist=function(a){var b=$(a).closest("div.answer");me.req({task:"loadUserList",box:b.dp("box"),answer:b.dp("a")},function(a){if(a.erfolg){me.info({type:false,title:a.title,message:a.code,button:["OK"],width:460})}else{me.error(a.error)}})};me.resizetextarea=function(c){a=c.value.split("\n");b=1;for(var d=0;d<a.length;d++){if(a[d].length>=c.cols)b+=Math.floor(a[d].length/c.cols)}b+=a.length;c.rows=b-1};me.commentopenclose=function(a){var b=$(a).closest("div.answer").find("div.comments");if(b.is(":empty")){me.commentgo($(a))}else if(b.height()==0){b.animate({height:b.find("div.commentbox,div.makenew,div.newcommentbox").totalOuterHeight(true)},"slow",function(){b.height("auto")})}else{b.animate({height:0},"slow")}};me.commentgo=function(a,b){var c=$(a).dp("box");var d=$(a).dp("a");b=$(a).data("p")||b;var e=$(a).closest("div.answer");var f=e.find("div[data-cp]").data("cp")-0||0;var g=me.gettemplate(e);if(me.lock(a))return;me.req({task:"loadComments",box:c,answer:d,page:b,currentpage:f},function(b){me.unlock(a);if(b.erfolg===1){var g=e.find("div.comments");if(f===0){if(!me.trigger(a,"commentGoFirstLoaded",e,c,d,b)){g.height(0).prepend(b.code).animate({height:g.find(".newcommentbox,[data-cp]").totalOuterHeight(true)},"slow",function(){g.height("auto")})}}else{var h=g.find(".commentbox").prepend(b.code),i=h.find("[data-cp]"),j=i.last(),k=i.first();h.animate({height:k.height()},"slow",function(){h.height("auto")});j.remove();k.hide().css({left:0,position:"relative"}).fadeIn("slow")}}else{me.error(b.error)}})};me.addcomment=function(a){var b=$(a).closest("div.answer");var c=b.find(".newcommentbox textarea").val();if(c===b.find(".newcommentbox textarea").data("start")||me.removebb(c)===""){me.error(me.jLang.noemptyordefault);return}if(me.lock(a))return;me.req({task:"addComment",box:b.dp("box"),answer:b.dp("a"),comment:c},function(a){me.commentadded(a,b)})};me.commentadded=function(a,b){if(a.error&&a.captcha==0){me.info({type:"error",title:"get.title",message:a.error,button:["OK","Cancel"],callback:function(){me.showcaptcha({task:"addComment",box:a.box,answer:a.answer,comment:a.comment,exec:function(a){me.commentadded(a,b)}})}})}else if(a.captcha==0){me.showcaptcha({task:"addComment",box:a.box,answer:a.answer,comment:a.comment,exec:function(a){me.commentadded(a,b)}})}else if(a.erfolg==1){me.unlock(b);me.commentgo(b,a.page);b.find(".newcommentbox textarea").trigger("text");$("[data-box="+a.box+"] [data-a="+a.answer+"] a.comment span").incr();me.notify(a.success)}else{me.unlock(b);me.error(a.error)}};me.removecomment=function(a){me.getlang();var b=$(a).closest("[data-c]").css("background-color","#FFE4E1");me.info({type:"question",title:me.jLang.titleQuestion,message:me.jLang.qremovecomment,buttons:["Yes","No"],callback:function(c){if(c===1){me.req({task:"removeComment",box:b.dp("box"),comment:b.dp("c")},function(c){if(c.erfolg==1){me.notify(c.success);$("[data-box="+c.box+"] [data-a="+c.answer+"] a.comment span").decr();if(b.siblings("div[data-c]").length>0){b.animate({height:0},"slow",function(){b.remove()})}else{me.commentgo(a,$(a).dp("cp"))}}else{me.error(c.error);b.css("background-color","transparent")}})}else{b.css("background-color","transparent")}}})};me.changecommentstate=function(a){var b=$(a).closest("[data-c]");me.req({task:"changePublishStateComment",box:b.dp("box"),comment:b.dp("c")},function(a){if(a.erfolg){me.notify(a.success);b.find("a.state").toggleClass("published unpublished")}else{me.error(a.error)}})};me.reportcomment=function(a){me.getlang();var b=$(a).closest("[data-c]");me.info({type:"question",title:me.jLang.titleQuestion,message:me.jLang.qreportcomment+"<br /> "+me.jLang.reportAddMessage+'<textarea id="jVS-report-message" cols=30 rows=2></textarea>',buttons:["Yes","No"],callback:function(c){if(c===1){me.req({task:"reportComment",box:b.dp("box"),comment:b.dp("c"),reportMessage:$("#jVS-report-message").val()},function(b){if(b.erfolg){me.notify(b.success);$(a).remove()}else{me.error(b.error)}})}}})};me.textareaResetTimer=null;me.insertcode=function(a){window.clearTimeout(me.textareaResetTimer);var b=$(a).data("insert");var c=$(a).parent().parent().find("textarea");c.insertcode(c.focus().range(),null,b)};me.insertbbcode=function(a){window.clearTimeout(me.textareaResetTimer);var b=$(a).data("bbcode");var c=$(a).parent().parent().find("textarea");var d=$(a).data("bbinfo");var e=c.focus().range();bb=b.split("{value}");if(e.len===0){var f='<textarea id="jVS-bbcode" cols=38 rows=1></textarea>';if(bb[0]==="[url]"){f='Title (optional):<textarea id="jVS-bbcode-urltitle" cols=38 rows=1></textarea><br /><br />URL:<textarea id="jVS-bbcode" cols=38 rows=1></textarea>'}me.info({type:false,title:d,message:f,callback:function(a){if(!a){var b=$("#jVS-bbcode-urltitle").val()||"";var d=$("#jVS-bbcode").val();if(b){d=b;b="="+$("#jVS-bbcode").val()}if(bb[0]==="[url]")bb[0]=bb[0].substring(0,bb[0].length-1)+b+bb[0].substring(bb[0].length-1,bb[0].length);c.insertcode(e,bb,d)}}});$("#jVS-bbcode").focus()}else{c.insertcode(e,bb)}};me.scrollto=function(a){$("html, body").animate({scrollTop:$(a).offset().top-50},500)};me.showMoreText=function(a){a.hide();var b=decodeURIComponent(a.find("span:first").html().replace(/\+/g,"%20"));a.parent().html(a.parent().html()+b)};me.userInfos=new Array;me.loadUserInfo=function(a,b){var c=a.dp("u");if(b==undefined){a.bind("mouseout",function(){window.clearTimeout(me.userInfoDelay)});me.userInfoDelay=window.setTimeout(function(){me.loadUserInfo(a,true)},200);return}if(me.userInfos[c]==undefined){me.req({task:"loadUserTooltip",uid:c},function(b){me.userInfos[c]=b.html;me.tip.show(a,me.userInfos[c])})}else{me.tip.show(a,me.userInfos[c])}};me.categoryInfos=new Array;me.loadCategoryInfo=function(a,b){var c=a.dp("cid");if(b==undefined){a.bind("mouseout",function(){window.clearTimeout(me.userInfoDelay)});me.userInfoDelay=window.setTimeout(function(){me.loadCategoryInfo(a,true)},200);return}if(me.categoryInfos[c]==undefined){me.req({task:"loadCategoryTooltip",cid:c},function(b){me.categoryInfos[c]=b.html;me.tip.show(a,me.categoryInfos[c])})}else{me.tip.show(a,me.categoryInfos[c])}};me.updateTimestamps=function(){me.getlang();$("#jvotesystem .update_timestamp[data-time]:visible, .jvotesystem .update_timestamp[data-time]:visible").each(function(){var a=parseInt($(this).dp("time"));var b=jvs_live_time;var c=b-a;var d="";if(c<60){count=c;d=count==1?me.jLang.second:me.jLang.seconds}else if(c<60*60){count=Math.round(c/60);d=count==1?me.jLang.minute:me.jLang.minutes}else if(c<60*60*24){count=Math.round(c/60/60);d=count==1?me.jLang.hour:me.jLang.hours}else if(c<60*60*24*7){count=Math.floor(c/60/60/24);d=count==1?me.jLang.day:me.jLang.days}else if(c<60*60*24*30){count=Math.floor(c/60/60/24/7);d=count==1?me.jLang.week:me.jLang.weeks}else if(c<60*60*24*365){count=Math.floor(c/60/60/24/30);d=count==1?me.jLang.month:me.jLang.months}else{count=Math.floor(c/60/60/24/365);d=count==1?me.jLang.year:me.jLang.years}var e=count+" "+d;if($(this).html()!=e)$(this).fadeOut("fast",function(){$(this).html(e).fadeIn("fast")})})};me.removePoll=function(a){me.getlang();me.info({type:"question",title:me.jLang.titleQuestion,message:me.jLang.qremovepoll,buttons:["Yes","No"],callback:function(b){if(b===1){me.req({task:"removePoll",box:a},function(b){if(b.erfolg){var c=$("div[data-box="+a+"]");var d=$("div[data-linkedto="+a+"]").slideUp("slow",function(){$(this).remove()});c.slideUp("slow",function(){c.html(b.code);c.slideDown("slow")})}else{me.error(b.error)}})}}})};me.loadSqueezebox=function(a,b,c,d){if(c==undefined)var c=820;if(d==undefined)var d=650;if(joomla15){$(a).attr("rel","{handler: 'iframe', closeBtn: false, closable: false, size: {x: "+c+", y: "+d+"}, onOpen: function(){jQuery('#sbox-btn-close').remove();jQuery('object').hide();}, onClose: function() {jQuery('object').show();}}").attr("href",b);SqueezeBox.fromElement(a)}else{SqueezeBox.open(b,{handler:"iframe",closeBtn:false,closable:false,size:{x:c,y:d},onOpen:function(){$("#sbox-btn-close").remove();$("object").hide()},onClose:function(){$("object").show()}})}};me.loadBannerScript=function(box,code){var src="http://pagead2.googlesyndication.com/pagead/show_ads.js";if(box==undefined){document.write(unescape("%3Cscript%20type%3D%22text%2Fjavascript%22%20src%3D%22")+src+unescape("%22%3E%3C%2Fscript%3E"))}else{var el=$("div[data-box="+box+"] .jvsbanner .bannercode");el.html("");domWrite(el.get(0),src,function(){eval(code)})}};me.tooltip_constructor=function(){var a={};a.loaded=false;a.shown=false;a.curX=0;a.curY=0;a.hideDelay=500;a.hideDelayTimer=null;$(document).ready(function(){var b=$("<div>").attr("class","jvotesystem vstooltip");a.el=$('<table class="vsbubble"><tbody><tr><td class="vscorner vstopleft"></td><td class="vstop"></td><td class="vscorner vstopright"></td></tr><tr><td class="vsleft"></td><td class="vscontent">'+"is loading..."+'</td><td class="vsright"></td></tr><tr><td class="vscorner vsbottomleft"></td><td class="vsbottom"><div></div></td><td class="vscorner vsbottomright"></td></tr></tbody></table>');b.append(a.el);a.el.bind("mouseenter",function(b){a.show()});a.el.bind("mouseleave destroyed",function(b){a.hideDelayTimer=setTimeout(function(){a.hide()},a.hideDelay)});$("body").append(b);a.el.hide();a.loaded=true});a.show=function(b,c){if(a.hideDelayTimer)window.clearTimeout(a.hideDelayTimer);if(b!=undefined){var d=$(b).offset().left;var e=$(b).offset().top}if((a.shown==false||d!=a.curX||e!=a.curY)&&b!=undefined){a.shown=true;a.el.find("td.vscontent").html(c);a.el.css({top:e-a.el.outerHeight(true)-12,left:d-a.el.outerWidth(true)+34+$(b).width()/2});a.curX=d;a.curY=e;b.bind("mouseleave destroyed",function(c){a.hideDelayTimer=window.setTimeout(function(){a.hide(b)},a.hideDelay)});a.el.fadeIn("fast")}};a.hide=function(b){a.el.fadeOut("fast");if(b!=undefined)b.unbind("mouseleave");a.shown=false};return a};me.tip=me.tooltip_constructor();return me}jVSQuery=jQuery.noConflict(true);(function(a,b,c){function j(a){var b={x:a.offsetLeft,y:a.offsetTop};while(a=a.offsetParent)b.x+=a.offsetLeft,b.y+=a.offsetTop;return b}function i(a){for(var b=1;b<arguments.length;b++){var d=arguments[b];for(var e in d)a[e]===c&&(a[e]=d[e])}return a}function h(a,b){for(var c in b)a.style[g(a,c)||c]=b[c];return a}function g(a,b){var d=a.style,e,f;if(d[b]!==c)return b;b=b.charAt(0).toUpperCase()+b.slice(1);for(f=0;f<k.length;f++){e=k[f]+b;if(d[e]!==c)return e}}function f(a,b,c,d){var e=["opacity",b,~~(a*100),c,d].join("-"),f=.01+c/d*100,g=Math.max(1-(1-a)/b*(100-f),a),h=m.substring(0,m.indexOf("Animation")).toLowerCase(),i=h&&"-"+h+"-"||"";return l[e]||(n.insertRule("@"+i+"keyframes "+e+"{"+"0%{opacity:"+g+"}"+f+"%{opacity:"+a+"}"+(f+.01)+"%{opacity:1}"+(f+b)%100+"%{opacity:"+a+"}"+"100%{opacity:"+g+"}"+"}",0),l[e]=1),e}function e(a){for(var b=1,c=arguments.length;b<c;b++)a.appendChild(arguments[b]);return a}function d(a,c){var d=b.createElement(a||"div"),e;for(e in c)d[e]=c[e];return d}var k=["webkit","Moz","ms","O"],l={},m,n=function(){var a=d("style");return e(b.getElementsByTagName("head")[0],a),a.sheet||a.styleSheet}(),o={lines:12,length:7,width:5,radius:10,color:"#000",speed:1,trail:100,opacity:.25,fps:20,zIndex:2e9,className:"spinner",top:"auto",left:"auto"},p=function q(a){if(!this.spin)return new q(a);this.opts=i(a||{},q.defaults,o)};p.defaults={},p.prototype={spin:function(a){this.stop();var b=this,c=b.opts,e=b.el=h(d(0,{className:c.className}),{position:"relative",zIndex:c.zIndex}),f=c.radius+c.length+c.width,g,i;a&&(a.insertBefore(e,a.firstChild||null),i=j(a),g=j(e),h(e,{left:(c.left=="auto"?i.x-g.x+(a.offsetWidth>>1):c.left+f)+"px",top:(c.top=="auto"?i.y-g.y+(a.offsetHeight>>1):c.top+f)+"px"})),e.setAttribute("aria-role","progressbar"),b.lines(e,b.opts);if(!m){var k=0,l=c.fps,n=l/c.speed,o=(1-c.opacity)/(n*c.trail/100),p=n/c.lines;!function q(){k++;for(var a=c.lines;a;a--){var d=Math.max(1-(k+a*p)%n*o,c.opacity);b.opacity(e,c.lines-a,d,c)}b.timeout=b.el&&setTimeout(q,~~(1e3/l))}()}return b},stop:function(){var a=this.el;return a&&(clearTimeout(this.timeout),a.parentNode&&a.parentNode.removeChild(a),this.el=c),this},lines:function(a,b){function c(a,c){return h(d(),{position:"absolute",width:b.length+b.width+"px",height:b.width+"px",background:a,boxShadow:c,transformOrigin:"left",transform:"rotate("+~~(360/b.lines*g)+"deg) translate("+b.radius+"px"+",0)",borderRadius:(b.width>>1)+"px"})}var g=0,i;for(;g<b.lines;g++)i=h(d(),{position:"absolute",top:1+~(b.width/2)+"px",transform:b.hwaccel?"translate3d(0,0,0)":"",opacity:b.opacity,animation:m&&f(b.opacity,b.trail,g,b.lines)+" "+1/b.speed+"s linear infinite"}),b.shadow&&e(i,h(c("#000","0 0 4px #000"),{top:"2px"})),e(a,e(i,c(b.color,"0 0 1px rgba(0,0,0,.1)")));return a},opacity:function(a,b,c){b<a.childNodes.length&&(a.childNodes[b].style.opacity=c)}},!function(){var a=h(d("group"),{behavior:"url(#default#VML)"}),b;if(!g(a,"transform")&&a.adj){for(b=4;b--;)n.addRule(["group","roundrect","fill","stroke"][b],"behavior:url(#default#VML)");p.prototype.lines=function(a,b){function f(a,f,i){e(k,e(h(c(),{rotation:360/b.lines*a+"deg",left:~~f}),e(h(d("roundrect",{arcsize:1}),{width:g,height:b.width,left:b.radius,top:-b.width>>1,filter:i}),d("fill",{color:b.color,opacity:b.opacity}),d("stroke",{opacity:0}))))}function c(){return h(d("group",{coordsize:i+" "+i,coordorigin:-g+" "+ -g}),{width:i,height:i})}var g=b.length+b.width,i=2*g,j=-(b.width+b.length)*2+"px",k=h(c(),{position:"absolute",top:j,left:j}),l;if(b.shadow)for(l=1;l<=b.lines;l++)f(l,-2,"progid:DXImageTransform.Microsoft.Blur(pixelradius=2,makeshadow=1,shadowopacity=.3)");for(l=1;l<=b.lines;l++)f(l);return e(a,k)},p.prototype.opacity=function(a,b,c,d){var e=a.firstChild;d=d.shadow&&d.lines||0,e&&b+d<e.childNodes.length&&(e=e.childNodes[b+d],e=e&&e.firstChild,e=e&&e.firstChild,e&&(e.opacity=c))}}else m=g(a,"animation")}(),a.jVS_Spinner=p})(window,document);(function(a){var b=jVSQuery.cleanData;a.cleanData=function(c){for(var d=0,f;(f=c[d])!==undefined;d++)a(f).triggerHandler("destroyed");b(c)}})(jVSQuery);(function($){$.Zebra_Dialog=function(){var defaults={animation_speed:250,auto_close:false,buttons:true,custom_class:false,keyboard:true,message:"",modal:true,overlay_close:true,overlay_opacity:.9,position:"center",title:"",type:"information",vcenter_short_message:true,width:0,onClose:null};var plugin=this;plugin.settings={};options={};if(typeof arguments[0]=="string"){options.message=arguments[0]}if(typeof arguments[0]=="object"||typeof arguments[1]=="object"){options=$.extend(options,typeof arguments[0]=="object"?arguments[0]:arguments[1])}plugin.init=function(){plugin.settings=$.extend({},defaults,options);plugin.isIE6=$.browser.msie&&parseInt($.browser.version,10)==6||false;if(plugin.settings.modal){plugin.overlay=$("<div>",{"class":"ZebraDialogOverlay"}).css({position:plugin.isIE6?"absolute":"fixed",left:0,top:0,opacity:plugin.settings.overlay_opacity,"z-index":1e3});if(plugin.settings.overlay_close){plugin.overlay.bind("click",plugin.close)}plugin.overlay.appendTo("body")}plugin.dialog=$("<div>",{"class":"ZebraDialog"+(plugin.settings.custom_class?" "+plugin.settings.custom_class:"")}).css({position:plugin.isIE6?"absolute":"fixed",left:0,top:0,"z-index":1001,visibility:"hidden"});if(!plugin.settings.buttons&&plugin.settings.auto_close){plugin.settings.uniqueid=(plugin.settings.position+plugin.settings.auto_close+"").replace(/\+/g,"inc").replace(/\-/g,"dec").replace(/[^a-z0-9]/gi,"");plugin.dialog.addClass(plugin.settings.uniqueid)}var a=parseInt(plugin.settings.width);if(!isNaN(a)&&a==plugin.settings.width&&a.toString()==plugin.settings.width.toString()&&a>0){plugin.dialog.css({width:plugin.settings.width})}if(plugin.settings.title){$("<h3>",{"class":"ZebraDialog_Title"}).html(plugin.settings.title).appendTo(plugin.dialog)}plugin.message=$("<div>",{"class":"ZebraDialog_Body"+(get_type()!=""?" ZebraDialog_Icon ZebraDialog_"+get_type():"")});if(plugin.settings.vcenter_short_message){$("<div>").html(plugin.settings.message).appendTo(plugin.message)}else{plugin.message.html(plugin.settings.message)}plugin.message.appendTo(plugin.dialog);var b=get_buttons();if(b){var c=$("<div>",{"class":"ZebraDialog_Buttons"}).appendTo(plugin.dialog);$.each(b,function(a,b){var d=$("<a>",{href:"javascript:void(0)","class":"ZebraDialog_Button"+a}).html(b);d.bind("click",function(){plugin.close(a)});d.appendTo(c)});$("<div>",{style:"clear:both"}).appendTo(c)}plugin.dialog.appendTo("body");$(window).bind("resize",draw);if(plugin.settings.keyboard){$(document).bind("keyup",_keyup)}if(plugin.isIE6){$(window).bind("scroll",_scroll)}if(plugin.settings.auto_close!==false){setTimeout(plugin.close,plugin.settings.auto_close)}draw();return plugin};plugin.close=function(){if(plugin.settings.keyboard){$(document).unbind("keyup",_keyup)}if(plugin.isIE6){$(window).unbind("scroll",_scroll)}$(window).unbind("resize",draw);if(plugin.overlay){plugin.overlay.animate({opacity:0},plugin.settings.animation_speed,function(){plugin.overlay.remove()})}plugin.dialog.animate({top:0,opacity:0},plugin.settings.animation_speed,function(){plugin.dialog.remove()});if(plugin.settings.onClose&&typeof plugin.settings.onClose=="function"){plugin.settings.onClose(undefined!=arguments[0]?arguments[0]:"")}};var draw=function(){var viewport_width=$(window).width(),viewport_height=$(window).height(),dialog_width=plugin.dialog.width(),dialog_height=plugin.dialog.height(),values={left:0,top:0,right:viewport_width-dialog_width,bottom:viewport_height-dialog_height,center:(viewport_width-dialog_width)/2,middle:(viewport_height-dialog_height)/2};plugin.dialog_left=undefined;plugin.dialog_top=undefined;if(plugin.settings.modal){plugin.overlay.css({width:viewport_width,height:viewport_height})}if($.isArray(plugin.settings.position)&&plugin.settings.position.length==2&&typeof plugin.settings.position[0]=="string"&&plugin.settings.position[0].match(/^(left|right|center)[\s0-9\+\-]*$/)&&typeof plugin.settings.position[1]=="string"&&plugin.settings.position[1].match(/^(top|bottom|middle)[\s0-9\+\-]*$/)){plugin.settings.position[0]=plugin.settings.position[0].toLowerCase();plugin.settings.position[1]=plugin.settings.position[1].toLowerCase();$.each(values,function(index,value){for(var i=0;i<2;i++){var tmp=plugin.settings.position[i].replace(index,value);if(tmp!=plugin.settings.position[i]){if(i==0){plugin.dialog_left=eval(tmp)}else{plugin.dialog_top=eval(tmp)}}}})}if(undefined==plugin.dialog_left||undefined==plugin.dialog_top){plugin.dialog_left=values.center;plugin.dialog_top=values.middle}if(plugin.settings.vcenter_short_message){var message=plugin.message.find("div:first"),message_height=message.height(),container_height=plugin.message.height();if(message_height<container_height){message.css({"margin-top":(container_height-message_height)/2})}}plugin.dialog.css({left:plugin.dialog_left,top:plugin.dialog_top,visibility:"visible"});plugin.dialog.find("a[class^=ZebraDialog_Button]:first").focus();if(plugin.isIE6){setTimeout(emulate_fixed_position,500)}};var emulate_fixed_position=function(){var a=$(window).scrollTop(),b=$(window).scrollLeft();if(plugin.settings.modal){plugin.overlay.css({top:a,left:b})}plugin.dialog.css({left:plugin.dialog_left+b,top:plugin.dialog_top+a})};var get_buttons=function(){if(plugin.settings.buttons!==true&&!$.isArray(plugin.settings.buttons)){return false}if(plugin.settings.buttons===true){switch(plugin.settings.type){case"question":plugin.settings.buttons=["Yes","No"];break;default:plugin.settings.buttons=["Ok"]}}return plugin.settings.buttons.reverse()};var get_type=function(){switch(plugin.settings.type){case"confirmation":case"error":case"information":case"question":case"warning":return plugin.settings.type.charAt(0).toUpperCase()+plugin.settings.type.slice(1).toLowerCase();break;default:return false}};var _keyup=function(a){if(a.which==27){plugin.close()}return true};var _scroll=function(){emulate_fixed_position()};return plugin.init()}})(jVSQuery);jVSQuery(document).ready(function(a){a("div.jvotesystem").jvslisten();a("#adminForm").on("click",".bbcodeToolbar img[data-insert]",function(a){jVS.insertcode(this)});a("#adminForm").on("click",".bbcodeToolbar img[data-bbcode]",function(a){jVS.insertbbcode(this)});if(a(".jvotesystem").length>0&&a(".jvotesystem").dp("box")){jvs_live_time=parseInt(jvs_live_time);jVS.liveTimeDiff=Date.UTC()-jvs_live_time;window.setInterval(function(){jvs_live_time+=10;jVS.updateTimestamps()},1e4)}a(window).on("mouseenter",".jvs_avatar[data-u], .jvotesystem [data-u], #jvotesystem [data-u]",function(b){jVS.loadUserInfo(a(this))});a(window).on("mouseenter",".jvotesystem [data-cid], #jvotesystem [data-cid]",function(b){jVS.loadCategoryInfo(a(this))})});(function(a){a.fn.incr=function(a){return this.text(function(b,c){return parseInt(c,10)+(a||1)})};a.fn.decr=function(a){return this.text(function(b,c){return parseInt(c,10)-(a||1)})};a.fn.intg=function(){return parseInt(this.html())};a.fn.dp=function(b){if(a(this).data(b)!=undefined){return a(this).data(b)}else{return a(this).closest("[data-"+b+"]").data(b)||false}};a.fn.spin=function(b){this.each(function(){var c=a(this),d=c.data();if(d.spinner){d.spinner.stop();delete d.spinner}if(b!==false){d.spinner=(new jVS_Spinner(a.extend({color:c.css("color")},{lines:14,length:17,width:19,radius:40,trail:91,speed:1.7,zIndex:99999},b))).spin(this)}});return this};a.fn.range=function(){var a=this[0];var b;var c;var d;var e;var f=a.value;var g=a.value.length;if(document.selection!=undefined){var h=document.selection.createRange();d=h.text;e=h.text.length;var i=h.duplicate();i.moveToElementText(a);i.setEndPoint("EndToEnd",h);b=i.text.length-e;c=b+e}else if(document.getSelection!=undefined){b=a.selectionStart;c=a.selectionEnd;e=c-b;d=a.value.substring(b,c)}else{alert("Your Browser doesn't support text selections! STOP!")}return{start:b,end:c,text:d,len:e,totlen:g,totext:f}};a.fn.setrange=function(a,b){var c=this[0];this.focus();if(document.selection!=undefined){var d=document.selection.createRange();d.moveToElementText(c);d.moveStart("character",a);d.moveEnd("character",-c.value.length+b);d.select()}else if(document.getSelection!=undefined){c.selectionStart=a;c.selectionEnd=b}};a.fn.insertcode=function(a,b,c){c=c||"";b=b||["",""];this.focus();this[0].value=a.totext.substring(0,a.start)+b[0]+(c||a.text)+b[1]+a.totext.substring(a.end,a.totlen);if(b[0]==="")a.end=a.start;this.setrange(a.start+b[0].length+c.length,a.end+b[0].length+c.length);this.trigger("keyup")};a.fn.totalOuterHeight=function(b){var c=0;that=b?this.filter(":visible"):this;that.each(function(b,d){c+=a(d).outerHeight(true)});return c};a.fn.jvslisten=function(){if(this.length===0){return}a.each(this,function(b,c){c=a(c);if(!c.dp("listened")&&c.dp("box")){c.attr("data-listened","1");c.on("click","a.vote",function(a){jVS.vote(this);a.preventDefault()});c.on("click","a.novote",function(a){a.preventDefault()});c.on("click",".answericons a.trash",function(a){jVS.removeanswer(this);a.preventDefault()});c.on("click",".comment a.trash",function(a){jVS.removecomment(this);a.preventDefault()});c.on("click",".answericons a.report",function(a){jVS.reportanswer(this);a.preventDefault()});c.on("click",".comment a.report",function(a){jVS.reportcomment(this);a.preventDefault()});c.on("click",".answericons a.state",function(a){jVS.changeanswerstate(this);a.preventDefault()});c.on("click",".comment a.state",function(a){jVS.changecommentstate(this);a.preventDefault()});c.on("click","a.userlist",function(a){jVS.loaduserlist(this);a.preventDefault()});c.on("click","a.comment",function(a){jVS.commentopenclose(this);a.preventDefault()});c.on("submit",".newanswerbox form",function(a){jVS.addanswer(this);a.preventDefault()});c.on("submit",".newcommentbox form",function(a){jVS.addcomment(this);a.preventDefault()});c.on("click",".bbcodeToolbar img[data-insert]",function(a){jVS.insertcode(this)});c.on("click",".bbcodeToolbar img[data-bbcode]",function(a){jVS.insertbbcode(this)});c.on("click","input[name=reset]",function(b){a(this).closest("form").find("textarea").trigger("text");b.preventDefault()});c.on("click","a.barchart.inactive,a.piechart.inactive",function(a){jVS.loadcharts(this)});c.on("click","a.barchart.active,a.piechart.active",function(a){jVS.leavecharts(this)});c.on("click",".commentsnavi a[data-p]",function(b){jVS.commentgo(a(this));b.preventDefault()});c.on("click",".answersnavi a[data-p]",function(b){jVS.go(a(this));b.preventDefault()});c.on("click",".showMoreText",function(b){jVS.showMoreText(a(this));b.preventDefault()});c.on("mouseenter",".vote-down",function(b){a(this).addClass("resetvotes");a(this).find(".operator").html("–")});c.on("mouseleave",".vote-down",function(b){a(this).removeClass("resetvotes");a(this).find(".operator").html("+")});c.on("click",".vote-down",function(a){jVS.resetvotes(this)});c.one("change","input[type=radio]",function(a){jVS.getlang(this,function(a){jVS.votebutton(a)})});c.on({text:function(){if(!jVS.trigger(this,"onTextareaText","bug",a(this))){a(this).val(a(this).data("start")).data("stored","").trigger("keyup");a(this).closest("form").find(".text, .comment-text").siblings(":not([data-nohide=true])").hide()}},focus:function(){if(a(this).hasClass("needLogin")){}else{if(!a(this).data("stored")){a(this).val("").data("stored","stored")}a(this).closest("form").find("div").fadeIn()}},blur:function(){if(a(this).val()==""){var b=a(this);jVS.textareaResetTimer=window.setTimeout(function(){b.trigger("text")},200)}},keyup:function(){jVS.resizetextarea(this)}},".newanswerbox textarea, .newcommentbox textarea");c.on("click",".needLogin",function(){jVS.error(jVS.translateStr("NeedToLogin"))});jVS.trigger(c,"construct","ToDo",c)}});return this}})(jVSQuery);var jVS=jVS_constructor()
